---
title: Signing and Verifying Off-Ledger Payments | XRPL Development Level 4
description: This page explains "Signing and Verifying Off-Ledger Payments" as part of the XRPL Development Level 4 curriculum.
sidebar:
  label: Signing and Verifying Off-Ledger Payments
  order: 5
---

import { Aside, Steps } from '@astrojs/starlight/components';

In this guide, we will explain the process of conducting 1,000 off-ledger payments and signing and verifying each payment.

## Creating the Script

<Steps>

1. Create a new file called `signPaymentChannelClaimAndVerify.js` in your project directory.
2. Paste the following code into `signPaymentChannelClaimAndVerify.js`.

    This guide introduces how to perform off-ledger payments, signing, and verification.

    * This code is a sample for making 1,000 payments.

    ```javascript
    import {
        signPaymentChannelClaim,
        verifyPaymentChannelClaim,
        xrpToDrops,
    } from 'xrpl';
    import { client, bobWallet } from './config.js';

    const signAndVerifyClaims = async (channel_id) => {
        let paychanSignature = '';

        console.time();
        for (let i = 1; i <= 1000; i++) {
            const amount = (0.001 * i).toFixed(6); // Fixed to 6 decimal places
            const amountFormatted = parseFloat(amount).toString(); // Specified in XRP

            // Sender: Sign the off-ledger payment
            paychanSignature = signPaymentChannelClaim(
                channel_id,
                amountFormatted, // Specified in XRP
                bobWallet.privateKey
            );

            // Recipient: Verify the off-ledger payment information
            if (
                !verifyPaymentChannelClaim(
                    channel_id,
                    amountFormatted, // Specified in XRP
                    paychanSignature,
                    bobWallet.publicKey
                )
            ) {
                throw new Error('Invalid signature');
            }
        }
        console.timeEnd();

        return paychanSignature;
    };

    const main = async () => {
        try {
            await client.connect();
            const channelId = 'channel ID'; // Enter the previously created channel ID
            const signature = await signAndVerifyClaims(channelId);
            console.log(`Generated signature: ${signature}`);
        } catch (error) {
            console.error('Error connecting to XRPL:', error);
        } finally {
            await client.disconnect();
        }
    };

    main();
    ```
</Steps>


## Running the Script

<Steps>

1. Run the script by executing the following command in the command line.

    ```bash
    node signPaymentChannelClaimAndVerify.js
    ```

2. If successful, the console will display the following:

    ```bash
    default: 1.605s
    Generated signature: C0D5F6A9908EE8AF579912215C3B765835210194CD6183DCE9128F3E6EE0991D98068968675C7A5B3E50DEC7D52BBAC970BC2305F063E04E52B60752921CCA01
    ```

    The time taken for 1,000 off-ledger payments was only `1.605s` (results from the local environment).

    As demonstrated, off-ledger transactions can process over 1,000 payments in a matter of seconds.

    <Aside>
    By having the sender sign the off-ledger payment and the recipient verify the signature, the validity of the off-ledger payment is confirmed. This process is crucial as part of payments made through a payment channel. 
    </Aside>
</Steps>

Next, we will introduce the method to claim funds.