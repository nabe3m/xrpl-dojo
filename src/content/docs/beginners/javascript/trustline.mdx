---
title: トラストラインの設定 | JavaScriptでのXRPL開発初級編
description: JavaScriptでXRPL開発するための初級編として、トラストライン機能について紹介しています。
sidebar:
  label: トラストラインの設定
  order: 2
---

import { Steps } from '@astrojs/starlight/components';

## トラストラインとは？

XRPL（XRP Ledger）のトラストライン機能は、ユーザーが特定の通貨を受け入れる意向を示すためのものです。これは、XRP以外の資産をXRPL上で取り扱うために使用されます。例えば、あるユーザーが別の通貨や発行体のトークンを受け入れる場合、そのユーザーはその通貨に対してトラストラインを設定する必要があります。

トラストライン機能によってユーザーは他のユーザーや発行体が発行した資産を自分のアカウントで保持し、取引することを許可しています。トラストラインを設定することで、そのユーザーのウォレットにその資産が表示され、取引が可能になります。

メリットとしては、受領を許可していないトークンを自身のアドレスに勝手に送金されることを防ぐことでき、ユーザー間の秩序を守ることができます。

## 前提

このガイドでは、以下の登場人物が登場する設定で進行します。

- チャーリー（トークン発行者）
- アリス（トークン受領者）

## スクリプトを作成

以下は、アリスからチャーリーにトラストラインをセットするスクリプトです。

<Steps>

1. プロジェクトディレクトリに`trust_set.js`という新しいファイルを作成します。
2. 以下のコードを`trust_set.js`に貼り付けます。

    ```javascript
    const xrpl = require('xrpl');

    async function trustSet() {
        // Testnetサーバーに接続します。Testnetは、XRP Ledgerの開発用テストネットワークです。
        const client = new xrpl.Client('wss://s.altnet.rippletest.net:51233');

        // client.connect()メソッドを呼び出して、サーバーに接続します。
        // awaitを使って、接続が完了するまで待機します。
        await client.connect();

        // トークン発行者のウォレットを設定（チャーリー）
        const issuerWallet = xrpl.Wallet.fromSeed('charlie_wallet_seed_here');

        // トークン受領者のウォレットを設定（アリス）
        const recipientWallet = xrpl.Wallet.fromSeed(
            'alice_wallet_seed_here'
        );

        const currencyCode = 'DOJ'; // トークンの通貨コード
        const amount = '10000'; // アリスが受領できるトークンの量の最大値（整数値）

        const result = await client.submitAndWait(
        {
            TransactionType: 'TrustSet',
            Account: recipientWallet.address, // アリスのアドレス
            LimitAmount: {
                issuer: issuerWallet.address, // チャーリーのアドレス（トークン発行者）
                currency: currencyCode, // DOJ
                value: amount, // 10000
            },
        },
        { wallet: recipientWallet } // アリスのウォレットで認証
        );

        console.log(result);

        client.disconnect();
    }

    trustSet().catch(console.error);
    ```

   1. `charlie_wallet_seed_here`には、テストネットのチャーリーのシークレットキーを入力してください。
   2. `alice_wallet_seed_here`には、テストネットのアリスのシークレットキーを入力してください。
</Steps>

## スクリプトの実行

1. コマンドラインで以下のコマンドを実行して、スクリプトを実行します。

    ```bash
    node trust_set.js
    ```

    成功すれば、コンソールに以下が表示されます。

    ```bash
    {
        id: 8,
        result: {
            Account: 'rusJXJ5ba76K9MBC7RcUyTCJx8XdEBHoi',
            Fee: '12',
            Flags: 0,
            LastLedgerSequence: 265645,
            LimitAmount: {
                currency: 'DOJ',
                issuer: 'rGrnqGxiW4AQd8bCjQrHBhAnTMvLVQe3iL',
                value: '10000'
            },
            Sequence: 265605,
            SigningPubKey: 'EDCA712B8F9BC3E586553FEA9F40395CC7EDE766D42D6EE3D8D0521422F48D0B70',
            TransactionType: 'TrustSet',
            TxnSignature: '7658F96EA716F7AA760B2CCA52F673DBB31AF70F7AB9B45BB6F06DDD180B18EC4E909D3A22B93C5F83116A2D81B6B2244FEF1DE0FF3338452DED7C9208DF8505',
            ctid: 'C0040D9A00000001',
            date: 767754233,
            hash: '3AB395F4D04A56AB59B80BD5A2856C9EF2F8F35D08B5F6AF1546F300872F2826',
            inLedger: 265626,
            ledger_index: 265626,
            meta: {
                AffectedNodes: [Array],
                TransactionIndex: 0,
                TransactionResult: 'tesSUCCESS' // 成功
            },
            validated: true
        },
        type: 'response'
    }
    ```

    これでチャーリーが発行するトークン（DOJ）をアリスが受け取ることが可能になりました。